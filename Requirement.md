# SHTechCraft - Mini Games

### 背景

SHTechCraft 的群友不定期会开展小游戏活动。目前的举办模式为，群友发布活动时间，收集参与意愿，然后根据人数选择活动项目。但是笔者注意到，这种组织模式有以下弊端：

* 需要参与者手动维护小游戏服务器。如果没有参与者愿意维护服务器，那活动也就无从谈起
* 时间不灵活。在确定游戏项目以后，必须要达到足够人数才能开启项目。由于第一条原因，在启动小游戏服务器以后，维护者更换小游戏较为麻烦，等待的沉没成本较大

基于以上原因，笔者提出由 SHTechCraft 维护一个小游戏群组服。它可以解决以上问题，并有更多的优点：

* 将服务器挂载于 GeekPie 服务器上，可以使用 k8s - docker 自动维护
* 时间灵活，组队自由。由于群组服提供了多个小游戏，在人数不足的情况下，在线玩家可以灵活切换到其他需求人数较少的小游戏中
* 培训运维新人。现阶段， SHTechCraft 运维团队即将毕业，SHTechCraft 面临在未来无人维护的情况。通过 SHTechCraft - Mini Games 这一项目，我们可以招募并培训运维新人，把 SHTechCraft 传承下来。另一方面，由于我们使用了 GeekPie 服务器，我们还可以为 GeekPie 社团招募运维同学。

### 工程内容

一个小游戏群组服的运行，需要以下内容：

* 群组服服务端
* 可以切换到其他小游戏的主城
* 小游戏

  * 小游戏玩法地图
  * 小游戏运行流程，包括游戏前小游戏地图的加载，游戏中的运行，游戏结束后的回收与重置

### 任务分配

基于以上工程内容，目前需要完成以下任务：

* 群组服服务端：

  * 选择什么样的服务端？ Waterfall/BungeeCord
  * 子服务器选择什么服务端，纯净服or模组服？ Paper等 
  * 如何在 GeekPie 服务器上用 k8s 部署？
  * 满足基本功能的主城？ Lobby System
  * 子服务器版本的选择？
  - 服务器基础镜像的选择？ eclipse-temurin:21-jre
* 小游戏：

  * 选择哪些小游戏？
  * 由于小游戏纷繁复杂，如何设计一个节省服务器资源的小游戏运行策略？
    * 比如把各个小游戏的子服务器打包成镜像，然后在需要时，加载这些镜像？
    * 资源限制应该是多少？
  - 插件功能：
	- 权限管理插件 Luckperms
	- 跨服聊天插件 BungeeChat
	- 跨版本兼容 ViaVersion,ProtocolSupport等
### 项目排期

排期不设具体日期，仅为一个可能的任务顺序

* 运行一个群组服 demo

  * 要求包含基本功能：

    * 登入主城 
    * 切换到不同服务器

* 稍后可以添加资源管理功能，即按需加载子服务器镜像为实例
	* EssentialsX+RCON
* 将 demo 中的子服务器替换为实际的小游戏服

### 架构设计
方案一：
![[deepseek_mermaid_20250811_789619.png]]
方案二：
![[deepseek_mermaid_20250811_7ecbc4.png]]